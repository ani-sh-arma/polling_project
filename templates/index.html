{% extends 'base.html' %} {% block style %}
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  .parent {
    height: fit-content;
    width: 98vw;
    display: grid;
    place-items: center;
  }
  .wrapper {
    padding-top: 20px;
    width: 80vw;
    display: grid;
    gap: 60px;
    padding-left: 50px;
    grid-template-columns: 1fr 1fr;
    /* grid-template-columns: repeat(auto-fit,minmax(250px,1fr)); */
  }
  weak {
    font-size: 14px;
    color: grey;
  }
  weak div {
    float: right;
    padding-right: 20px;
  }
  .pollContent {
    min-width: 300px;
    width: 500px;
    border: 1px solid grey;
    border-radius: 1rem;
  }

  .options {
    height: 40px;
    padding: 5px 0px;
    border: 1px solid black;
    margin-bottom: 5px;
    border-radius: 5px;
  }

  .options:hover {
    background-color: grey;
  }
</style>
{% endblock style %} {% block body %}

<div>
  <form action="">
    <!-- <label for="search" class="form-label">Search</label> -->
    <input
      type="text"
      id="search"
      name="search"
      class="form-control"
      placeholder="Search"
    />

    <button type="submit" class="btn btn-primary" style="float: right">
      Submit
    </button>
  </form>
</div>

<div class="wrapper">
  {% comment %} {% load custom_filters %} {% endcomment %} {% comment %} {% if
  poll|is_string %} {% endcomment %}

  <p>{{poll}}</p>

  {% comment %} {% else %} {% endcomment %}
   {% for poll in polls %}

  <!-- {% comment %} <div class="row row-cols-1 row-cols-md-3 g-4 pollContent">
        <div class="col">
            <div class="card h-100"> {% endcomment %} -->

  <div
    class="card-body pollContent poll"
    style="min-width: 400px; overflow: wrap"
  >
    <h5 class="card-title">{{poll.question}}</h5>
    <weak>
      Created by : {{poll.creator}}
      <div>Date : {{poll.date}}</div> </weak
    ><br /><br />
    <div name="answer1" class="options vote-button">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option1}}
    </div>
    <div name="answer2" class="options vote-button">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option2}}
    </div>
    <div name="answer3" class="options vote-button">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option3}}
    </div>
    <div name="answer4" class="options vote-button">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option4}}
    </div>
    <div name="answer5" class="options vote-button">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option5}}
    </div>

    <!-- <a href=""><div name="answer1" class="options vote-button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option1}}</div></a>
            <a href=""><div name="answer2" class="options vote-button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option2}}</div></a>
            <a href=""><div name="answer3" class="options vote-button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option3}}</div></a>
            <a href=""><div name="answer4" class="options vote-button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option4}}</div></a>
            <a href=""><div name="answer5" class="options vote-button">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{poll.option5}}</div></a> -->
  </div>

  <!-- Your HTML template -->
  <!-- <div class="poll" data-poll-id="{{ poll.id }}">
            <p>{{ poll.question }}</p>
            <button class="vote-button">Vote</button>
        </div> -->

  <!-- AJAX requests to handle voting -->

  <!-- <script>
        document.addEventListener("DOMContentLoaded", function() {
            var voteButtons = document.querySelectorAll(".vote-button");
            voteButtons.forEach(function(button) {
                button.addEventListener("click", function() {
                    var pollId = this.closest(".poll").getAttribute("data-poll-id");
                    var option = this.getAttribute("name"); // Get the name attribute instead of data-option
                    
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", "/vote/", true);
                    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
                    
                    xhr.onreadystatechange = function() {
                        if (xhr.readyState === XMLHttpRequest.DONE) {
                            if (xhr.status === 200) {
                                var response = JSON.parse(xhr.responseText);
                            if (response.success) {
                                var voteCount = response.vote_count;
                                var voteCountElement = document.querySelector(".vote-count[data-option='" + option + "']");
                                voteCountElement.textContent = "Votes: " + voteCount;
                            } else {
                                alert("Failed to vote.");
                            }
                        } else {
                            alert("Error occurred.");
                        }
                    }
                };
        
                var formData = "poll_id=" + pollId + "&option=" + option;
                xhr.send(formData);
            });
        });
    });
</script> -->

  {% endfor %} 
  {% comment %} {% endif %} {% endcomment %}
</div>

{% endblock body %}
